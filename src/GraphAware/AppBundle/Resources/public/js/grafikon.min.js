// Grafikon - JQuery Charts Plugin
// Copyright (c) 2015 Dimitar Deskov

function getTextWidthDOM(e,t){var n=t||"12px arial",a=$("<span>"+e+"</span>").css({font:n,"float":"left","white-space":"nowrap"}).appendTo($("body")),i=a.width();return a.remove(),i}function cutLastArc(e,t,n,a,i,l,o){e.save(),e.beginPath(),e.arc(t,n,a,i,l,o),e.closePath(),e.globalCompositeOperation="destination-out",e.fill(),e.restore()}function wrapText(e,t,n,a,i,l){for(var o=t.split(" "),r="",s=0;s<o.length;s++){var c=r+o[s]+" ",d=e.measureText(c),f=d.width;f>i&&s>0?(e.fillText(r,n,a),r=o[s]+" ",a+=l):r=c}e.fillText(r,n,a)}function inWords(e){if(e=parseInt(e,10)+1,(e=e.toString()).length>9)return"overflow";if(n=("000000000"+e).substr(-9).match(/^(\d{2})(\d{2})(\d{2})(\d{1})(\d{2})$/),n){var t="";return t+=0!=n[4]?(a[Number(n[4])]||b[n[4][0]]+a[n[4][1]])+"hundred":"",t+=0!=n[5]?(""!=t?"and":"")+(a[Number(n[5])]||b[n[5][0]]+a[n[5][1]]):"",0==e&&(t="null"),t}}function brighten(e,t){var n=parseInt(e.substring(1,3),16),a=parseInt(e.substring(3,5),16),i=parseInt(e.substring(5,7),16);n=parseInt(n*(100+t)/100,10),a=parseInt(a*(100+t)/100,10),i=parseInt(i*(100+t)/100,10),n=255>n?n:255,a=255>a?a:255,i=255>i?i:255;var l=1==n.toString(16).length?"1"+n.toString(16):n.toString(16),o=1==a.toString(16).length?"1"+a.toString(16):a.toString(16),r=1==i.toString(16).length?"1"+i.toString(16):i.toString(16);return"#"+l+o+r}function hiddenElSize(e){var t,n=0,a=document.querySelector(e);a.setAttribute("style","visibility: hidden; display: block;");var t=a.clientWidth,n=a.clientHeight;return a.setAttribute("style","visibility: visible;"),{widthEl:t,heightEl:n}}function getRandomInRange(e,t,n){return 1*(Math.random()*(t-e)+e).toFixed(n)}function eventFunc(){}function relMouseCoords(e){function t(){var e=navigator.userAgent.indexOf(".NET CLR")>-1,t=e||-1!=navigator.appVersion.indexOf("MSIE");return t}var n=0,a=0,i=0,l=0,o=this;do n+=o.offsetLeft-o.scrollLeft,a+=o.offsetTop-o.scrollTop;while(o=o.offsetParent);var r=Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,s="undefined"!=typeof InstallTrigger,c=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;return c||r?(i=e.pageX-n,l=e.pageY-a-window.pageYOffset):s||t?(i=e.pageX-n,l=e.pageY-a):(i=e.pageX-n,l=e.pageY-a-window.pageYOffset),{x:i,y:l,tLeftX:n}}!function(e){window.resArr=[],window.resValuesArr=[],e.fn.grafikon=function(t){var n={mode:"evaluation",size:null,width:700,height:500,general:{fontSize:"medium",fontFamily:"Arial",fontWeight:"normal",fontVariant:"normal",fontColor:"#000"},evaluation:{click:!1,sections:1,levels:2,points:null,separator:!1,separatorColor:"#fff",activeColor:"#14a0ef",directionColor:"no",inactiveColor:"#E7F5FD",infoIn:!1,infoInBackground:"#fff",distanceFromCentre:9,infoOut:null,results:"points",resultsBackground:"#fff",resultsEffect:!1,resultsFontColor:"#000"},pyramid:{sections:6,activeColor:["#ff7f00","#ffdc3a","#cfd051","#92b55b","#1c2f36","#A2322E"],title:null,percent:null},statistic:{click:!1,sections:1,separator:!1,separatorColor:"#fff",bubble:!1,statisticId:"grafikon-statistic-data",percentIn:!1,distanceFromCentre:9,percentOut:!1,holeSize:5},progress:{percent:0,startAngle:90,centerSize:5,activeColor:"#537335",inactiveColor:"#bedca1"},line:{XData:null,YData:null,lineTitle:null,lineData:null,lineColor:["#2a9c8a","#be4f44","#54314d"],suffix:"%",canvasPadding:null,canvasPaddingX:null,canvasPaddingY:null,pointOrbit:!1,coordLineColor:"#333",coordNullPointColor:"#000",matrixColor:"#cfcfcf",legend:"right"},animation:{status:!1,duration:1200,effect:"fade"},download:{status:!1,id:"grafikon-download",fileName:null},responsive:{status:!1,maxSize:null,minSize:200}},a=e.extend(!0,n,t);if(a.pie)for(key in a.pie)a.statistic[key]=a.pie[key];else if(a.doughnut)for(key in a.doughnut)a.statistic[key]=a.doughnut[key];switch(a.general.fontSize){case"small":a.general.fontSize=12;break;case"medium":a.general.fontSize=14;break;case"large":a.general.fontSize=18;break;case"very large":a.general.fontSize=22}return this.each(function(){function t(){if(a.evaluation.levels=a.evaluation.levels+1,null!=a.evaluation.points&&a.evaluation.points.forEach(function(e,t){e=a.evaluation.levels-(e+1);var n="data-"+inWords(t);lt.setAttribute(n,parseInt(e,10))}),a.evaluation.activeColor instanceof Array)for(var e=0;e<a.evaluation.activeColor.length;e++){for(Q=[],T=0;T<a.evaluation.levels;T++)T!=a.evaluation.levels-1&&"light"==a.evaluation.directionColor?Q.push(brighten(a.evaluation.activeColor[e],10*T)):T!=a.evaluation.levels-1&&"dark"==a.evaluation.directionColor?Q.push(brighten(a.evaluation.activeColor[e],10*-T)):T!=a.evaluation.levels-1&&"no"==a.evaluation.directionColor&&Q.push(a.evaluation.activeColor[e]);$.push(Q)}else for(var e=0;1>e;e++){for(Q=[],T=0;T<a.evaluation.levels;T++)T!=a.evaluation.levels-1&&"light"==a.evaluation.directionColor?Q.push(brighten(a.evaluation.activeColor,10*T)):T!=a.evaluation.levels-1&&"dark"==a.evaluation.directionColor?Q.push(brighten(a.evaluation.activeColor,10*-T)):T!=a.evaluation.levels-1&&"no"==a.evaluation.directionColor&&Q.push(a.evaluation.activeColor);$.push(Q)}for(a.evaluation.infoOut&&!a.statistic.percentIn?(Math.abs(ot-rt)>=200?chartRadius=Math.min(ot-60,rt-60)/2:(chartRadius=Math.min(ot-150,rt-150)/2,rt-=90,et.css("height",rt),lt.setAttribute("height",rt)),K=rt/2,J=ot/2):(chartRadius=Math.min(ot-20,rt-20)/2,K=rt/2,J=ot/2),T=0;T<a.evaluation.levels;T++)j.push(chartRadius-chartRadius/a.evaluation.levels*T);for(T=0;T<a.evaluation.sections;T++)U[T]=[];var t=0;for(z in U)U[z].startAngle=2*Math.PI*t,U[z].endAngle=2*Math.PI*(t+1/a.evaluation.sections),t+=1/a.evaluation.sections;var i=et[0];N.removeEventsByTypeEx(i,"click"),1==a.evaluation.click&&(N.regEventEx(i,"click",n),lt.style.cursor="pointer")}function n(e){if(!a.evaluation.points)for(a.evaluation.points=[],T=0;T<a.evaluation.sections;T++)a.evaluation.points[T]=0;if(E=lt.relMouseCoords(e),D=E.x,F=E.y,I=D-J,X=F-K,Y=Math.sqrt(Math.pow(Math.abs(I),2)+Math.pow(Math.abs(X),2)),Y<=j[0]){W=Math.atan2(X,I)-G,0>W&&(W=2*Math.PI+W);for(z in U)if(W>=U[z].startAngle&&W<=U[z].endAngle){for(T=a.evaluation.levels-1;T>=0;T--)if(Y<=j[T]&&Y>j[a.evaluation.levels-1]){lt.getAttribute("data-"+inWords(z))==T?(lt.setAttribute("data-"+inWords(z),T+1),a.evaluation.points[z]=a.evaluation.levels-T-2):(lt.setAttribute("data-"+inWords(z),T),a.evaluation.points[z]=a.evaluation.levels-T-1);break}return void h()}}}function i(e,t){var n=U[t].startAngle+G,i=U[t].endAngle+G,l=null;for(T=0;T<a.evaluation.levels-1;T++){var l=parseInt(lt.getAttribute("data-"+inWords(t)),10);e.beginPath(),e.moveTo(J,K),e.arc(J,K,j[T],n,i,!1),e.closePath(),e.fillStyle=T==a.evaluation.levels-1?a.evaluation.separatorColor:a.evaluation.inactiveColor,a.evaluation.activeColor instanceof Array&&T>=l&&T!=a.evaluation.levels-1&&$.length>t?e.fillStyle=$[t][T]:T>=l&&T!=a.evaluation.levels-1&&(e.fillStyle=$[0][T]),e.fill(),e.lineWidth=1,e.strokeStyle=a.evaluation.separatorColor,e.stroke()}}function l(e,t){var n=U[t].startAngle+G,i=U[t].endAngle+G;if(a.evaluation.infoIn){if(Y=7-1*a.evaluation.distanceFromCentre/2,a.evaluation.infoOut&&Math.min(ot-20,rt-20)>400){if(Math.abs(ot-rt)>=200)var l=J+Math.min(ot-60,rt-60)/Y*Math.cos((n+i)/2),o=K+Math.min(ot-60,rt-60)/Y*Math.sin((n+i)/2);else var l=J+Math.min(ot-150,rt-150)/Y*Math.cos((n+i)/2),o=K+Math.min(ot-150,rt-150)/Y*Math.sin((n+i)/2);e.beginPath(),e.arc(l,o,a.general.fontSize,0,2*Math.PI,!1),e.fillStyle=a.evaluation.infoInBackground,e.fill(),e.closePath()}else if(!a.evaluation.infoOut&&Math.min(ot-20,rt-20)>250){var l=J+Math.min(ot-20,rt-20)/Y*Math.cos((n+i)/2),o=K+Math.min(ot-20,rt-20)/Y*Math.sin((n+i)/2);e.beginPath(),e.arc(l,o,a.general.fontSize,0,2*Math.PI,!1),e.fillStyle=a.evaluation.infoInBackground,e.fill(),e.closePath()}e.save(),e.font=a.general.fontVariant+_+a.general.fontWeight+_+a.general.fontSize+"px"+_+a.general.fontFamily,e.textAlign="center",e.fillStyle=a.general.fontColor,"points"==a.evaluation.infoIn&&Math.min(ot-20,rt-20)>400?e.fillText(a.evaluation.points[t],l,o+a.general.fontSize/2.8):"number"==a.evaluation.infoIn&&Math.min(ot-20,rt-20)>250&&e.fillText(parseInt(t,10)+1,l,o+a.general.fontSize/2.8),e.restore()}if(a.evaluation.infoOut){if(Math.abs(ot-rt)>=200)var l=J+Math.min(ot-20,rt-20)/2*Math.cos((n+i)/2),o=K+Math.min(ot-20,rt-20)/2*Math.sin((n+i)/2);else var l=J+Math.min(ot-150,rt-50)/2*Math.cos((n+i)/2),o=K+Math.min(ot-150,rt-50)/2*Math.sin((n+i)/2);e.textAlign=U[t].startAngle<3?"left":"right",U[t].endAngle>1.5&&U[t].startAngle<4.5&&(o+=9),e.save(),e.fillStyle=a.general.fontColor,e.font=a.general.fontVariant+_+a.general.fontWeight+_+a.general.fontSize+"px"+_+a.general.fontFamily,e.fillText(a.evaluation.infoOut[t],l,o),e.restore()}}function o(e){var t=0,n=0,i=0,l=0;if(e.save(),a.evaluation.resultsEffect&&(e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=10,e.shadowColor="#656565"),e.beginPath(),e.arc(J,K,j[j.length-1],0,2*Math.PI,!1),e.fillStyle=a.evaluation.resultsBackground,e.fill(),e.closePath(),e.strokeStyle=a.evaluation.separator?a.evaluation.separatorColor:a.evaluation.inactiveColor,e.lineWidth=2,e.strokeStyle=a.evaluation.separatorColor,e.stroke(),e.restore(),a.evaluation.points){for(T=0;T<a.evaluation.sections;T++)t+=parseInt(a.evaluation.points[T],10);n=Math.round(t/((a.evaluation.levels-1)*a.evaluation.sections)*100)}else n="percent"==a.evaluation.results?"%":"-";e.save(),i=j[j.length-1]-20*j[j.length-1]/100,l=i/2-Math.round(17*i/100),e.font=i+"px Times New Roman, serif",e.textAlign="center",e.fillStyle=a.evaluation.resultsFontColor,"percent"==a.evaluation.results?e.fillText(n,J,K+l):e.fillText(t,J,K+l),e.restore()}function r(){var t='<div class="grafikon-bubble" style="display: none;"><span class="triangle"></span></div>',n='<div class="grafikon-moreInfo" style="display: none;"></div>';for(et.append(a.statistic.click?t+n:t),(1==a.statistic.sections||null==a.statistic.sections)&&(a.statistic.sections=e(at).children().length),J=ot/2,K=rt/2,chartRadius=a.statistic.percentOut?Math.min(ot-120,rt-120)/2:a.statistic.click?Math.min(ot-30,rt-30)/2:Math.min(ot,rt)/2,"doughnut"==a.mode?(j.push(chartRadius),O=2-1*a.statistic.holeSize/10,j.push(chartRadius/O)):j.push(chartRadius),T=0;T<a.statistic.sections;T++)U[T]=[];var i=0,l=0;for(z in U){var o=e(at).children().eq(z).attr("data-value"),r=parseInt(o,10);if(r){U[z].value=r;var d=o.replace(/\d+/g,"");U[z].unit=d}else U[z].value=0,U[z].unit="",o=0;l+=r}for(z in U){var f=parseInt(e(at).children().eq(z).attr("data-percent"),10),v=e(at).children().eq(z).attr("data-title"),g=e(at).children().eq(z).attr("data-color");U[z].title=v,U[z].color=g,l&&(f=U[z].value/l*100),U[z].percent=Math.round(10*f)/10,U[z].startAngle=2*Math.PI*i,U[z].endAngle=2*Math.PI*(i+f/100),i+=f/100}N.removeEventsByTypeEx(et[0],"mousemove"),N.removeEventsByTypeEx(et[0],"click"),1==a.statistic.bubble&&N.regEventEx(et[0],"mousemove",s),a.statistic.click&&(N.regEventEx(et[0],"click",c),et.find("canvas").css("cursor","pointer"))}function s(t){var n=e(tt+".grafikon-bubble");if(n.removeClass(),n.addClass("grafikon-bubble").css("display","none"),E=lt.relMouseCoords(t),D=E.x,F=E.y,I=D-J,X=F-K,Y=Math.sqrt(Math.pow(Math.abs(I),2)+Math.pow(Math.abs(X),2)),Y<=j[0]){W=Math.atan2(X,I)-G,0>W&&(W=2*Math.PI+W);for(z in U)if(W>=U[z].startAngle&&W<=U[z].endAngle)for(T=1;T>=0;T--){if(Y<=j[T]&&Y>j[1]||"pie"==a.mode){a.statistic.click&&et.find("canvas").css("cursor","pointer"),n.html(U[z].value?"<p class='grafikon-slice-title'>"+U[z].title+"</p><p class='grafikon-slice-value'><span class='grafikon-slice-value'>Val: </span>"+U[z].value+"<span class='grafikon-slice-unit'>"+U[z].unit+"</span></p>":a.statistic.percentOut||a.statistic.percentIn?"<p class='grafikon-slice-title'>"+U[z].title+"</p>":"<p class='grafikon-slice-title'>"+U[z].title+"</p><p class='grafikon-slice-percent'>"+U[z].percent+"%</p>"),n.removeClass(),n.addClass("grafikon-bubble").css("display","block");var i=n.height(),l=n.width();return n.css("top",F-i-35+"px"),void n.css("left",D-l/2-5+"px")}et.find("canvas").css("cursor","default")}}}function c(t){var n=e(tt+".grafikon-moreInfo");if(E=lt.relMouseCoords(t),D=E.x,F=E.y,I=D-J,X=F-K,Y=Math.sqrt(Math.pow(Math.abs(I),2)+Math.pow(Math.abs(X),2)),Y<=j[0]){W=Math.atan2(X,I)-G,0>W&&(W=2*Math.PI+W);for(z in U)if(W>=U[z].startAngle&&W<=U[z].endAngle)for(T=1;T>=0;T--)if(Y<=j[T]&&Y>j[1]||"pie"==a.mode){var i=hiddenElSize(tt+".grafikon-moreInfo").widthEl+20,l=window.innerWidth-(E.tLeftX+lt.width);l>i?(n.css("left",null),n.css("right",-i+"px")):i<E.tLeftX?(n.css("right",null),n.css("left",-i+"px")):(n.css("right",null),n.css("left","0px"));var o=lt.getAttribute("actSlice"),r="<h1>"+U[z].title+"</h1>"+e(at).children().eq(z).html();return n.html(r),o==z?(lt.removeAttribute("actSlice"),n.removeClass(),n.addClass("grafikon-moreInfo grafikon-more-box-"+inWords(z)).css("display","none")):(lt.setAttribute("actSlice",z),n.removeClass(),n.addClass("grafikon-moreInfo grafikon-more-box-"+inWords(z)).css("display","block")),void h()}}}function d(e,t){var n=U[t].startAngle+G,i=U[t].endAngle+G,l=null;l=parseInt(lt.getAttribute("actSlice"),10),e.beginPath(),e.moveTo(J,K),t==l?e.arc(J,K,j[0]+ot/65,n,i,!1):e.arc(J,K,j[0],n,i,!1),e.closePath(),e.fillStyle=U[t].color,e.fill(),e.strokeStyle=a.statistic.separator?a.statistic.separatorColor:U[t].color,e.lineWidth=1,e.stroke()}function f(e,t){var n=U[t].startAngle+G,i=U[t].endAngle+G;if(a.statistic.percentIn&&U[t].percent>=10){Y=12-a.statistic.distanceFromCentre;var l=J+ot/Y*Math.cos((n+i)/2),o=K+ot/Y*Math.sin((n+i)/2);e.font=a.general.fontVariant+_+a.general.fontWeight+_+a.general.fontSize+"px"+_+a.general.fontFamily,e.textAlign="center",e.fillStyle=a.general.fontColor,e.fillText(U[t].percent+"%",l,o)}else if(a.statistic.percentOut){var l=J+(ot-120)/1.8*Math.cos((n+i)/2),o=K+(ot-120)/1.8*Math.sin((n+i)/2);e.font=a.general.fontVariant+_+a.general.fontWeight+_+a.general.fontSize+"px"+_+a.general.fontFamily,U[t].endAngle>1.5&&U[t].startAngle<4.5&&(o+=9),e.textAlign=U[t].startAngle<3?"left":"right",e.fillStyle=U[t].color,e.fillText(U[t].percent+"%",l,o)}}function v(){for(G=a.progress.startAngle*(Math.PI/180),J=ot/2,K=rt/2,chartRadius=Math.min(ot,rt)/2,j.push(chartRadius),O=2-1*a.progress.centerSize/10,j.push(chartRadius/O),T=0;2>T;T++)U[T]=[];var e=0,t=[a.progress.percent,100-a.progress.percent];Q=[a.progress.activeColor,a.progress.inactiveColor];for(z in U){var n=t[z];color=Q[z],U[z].color=color,U[z].percent=Math.round(10*n)/10,U[z].startAngle=2*Math.PI*e,U[z].endAngle=2*Math.PI*(e+n/100),e+=n/100}}function g(e,t){var n=U[t].startAngle+G,a=U[t].endAngle+G;e.beginPath(),e.moveTo(J,K),e.arc(J,K,j[0],n,a,!1),e.closePath(),e.fillStyle=U[t].color,e.fill()}function u(e){e.textAlign="center",e.fillStyle=a.progress.activeColor,e.save(),textSize=j[j.length-1]-20*j[j.length-1]/100,q=textSize/2-Math.round(17*textSize/100),e.font=a.general.fontVariant+_+a.general.fontWeight+_+textSize+"px"+_+a.general.fontFamily,e.fillText(a.progress.percent,J,K+q),e.restore(),e.save(),signSize=textSize/4,e.font=a.general.fontVariant+_+a.general.fontWeight+_+signSize+"px"+_+a.general.fontFamily,a.progress.percent>=0&&a.progress.percent<10?e.fillText("%",J+textSize/3.5+signSize/1.5,K-q/2):a.progress.percent>=100?e.fillText("%",J+textSize/1.3+signSize/1.5,K-q/2):e.fillText("%",J+textSize/2+signSize/1.5,K-q/2),e.restore()}function h(){k=lt.getContext("2d"),k.clearRect(0,0,lt.width,lt.height);for(z in U)"doughnut"==a.mode||"pie"==a.mode?(d(k,z),f(k,z)):"evaluation"==a.mode?(i(k,z),l(k,z)):"progress"==a.mode&&g(k,z);for(z in U)"doughnut"==a.mode||"pie"==a.mode?f(k,z):"evaluation"==a.mode&&l(k,z);"pie"!=a.mode&&cutLastArc(k,J,K,j[j.length-1],0,2*Math.PI,!1),"evaluation"==a.mode?o(k,z):"progress"==a.mode&&u(k)}function p(e){k=lt.getContext("2d"),m(),K=rt/2,J=ot/2,y(k),P(k),N.removeEventsByTypeEx(e[0],"mousemove"),N.removeEventsByTypeEx(e[0],"click"),N.regEventEx(e[0],"mousemove",x),N.regEventEx(e[0],"click",w)}function m(){var e=0;if("right"==a.line.legend)for(T=0;T<=a.line.lineTitle.length-1;T++){var t=a.line.lineTitle[T],n=getTextWidthDOM(t,a.general.fontSize+"px"+_+a.general.fontFamily);n>e&&(e=n)}for(T=0;T<=a.line.YData.length-1;T++){var t=a.line.YData[T],n=getTextWidthDOM(t+a.line.suffix,a.general.fontSize+"px"+_+a.general.fontFamily);n>e&&(e=n)}canvasPaddingX=a.line.canvasPadding?a.line.canvasPadding:a.line.canvasPaddingX?a.line.canvasPaddingX:e+30,a.line.canvasPadding?canvasPaddingY=a.line.canvasPadding:a.line.canvasPaddingY?canvasPaddingY=a.line.canvasPaddingY:a.line.canvasPaddingY||(canvasPaddingY=50)}function y(e){var t,n,i,l=(rt-2*canvasPaddingY)/a.line.YData.length,o=(ot-2*canvasPaddingX)/a.line.XData.length,r=0,s=0,c=6.5-Math.round(2.21);for(e.beginPath(),e.moveTo(canvasPaddingX,rt-canvasPaddingY),e.lineTo(ot-canvasPaddingX,rt-canvasPaddingY),e.strokeStyle=a.line.coordLineColor,e.lineWidth=2,e.stroke(),e.closePath(),e.beginPath(),e.moveTo(canvasPaddingX,rt-canvasPaddingY),e.lineTo(canvasPaddingX,canvasPaddingY),e.strokeStyle=a.line.coordLineColor,e.lineWidth=2,e.stroke(),e.closePath(),t=canvasPaddingY+l,i=0,T=0;T<=a.line.YData.length-1;T++)e.beginPath(),e.moveTo(canvasPaddingX,rt-t),e.lineTo(ot-canvasPaddingX,rt-t),e.strokeStyle=a.line.matrixColor,e.lineWidth=1,e.stroke(),e.closePath(),e.beginPath(),e.moveTo(canvasPaddingX,rt-t),e.arc(canvasPaddingX,rt-t,5,0,2*Math.PI,!1),e.fillStyle=a.line.coordLineColor,e.fill(),e.closePath(),e.beginPath(),e.font=a.general.fontVariant+_+a.general.fontWeight+_+a.general.fontSize+"px"+_+a.general.fontFamily,e.fillStyle=a.general.fontColor,e.textAlign="right",e.fillText(a.line.YData[i]+a.line.suffix,canvasPaddingX-10,rt-t+c),e.closePath(),t+=l,i++;for(n=canvasPaddingX+o,i=0,T=0;T<=a.line.XData.length-1;T++)e.beginPath(),e.moveTo(n,rt-canvasPaddingY),e.lineTo(n,canvasPaddingY),e.strokeStyle=a.line.matrixColor,e.stroke(),e.closePath(),e.beginPath(),e.moveTo(n,rt-canvasPaddingY),e.arc(n,rt-canvasPaddingY,5,0,2*Math.PI,!1),e.fillStyle=a.line.coordLineColor,e.fill(),e.closePath(),e.beginPath(),e.font=a.general.fontVariant+_+a.general.fontWeight+_+a.general.fontSize+"px"+_+a.general.fontFamily,e.fillStyle=a.general.fontColor,e.textAlign="center",e.fillText(a.line.XData[i],n,rt-canvasPaddingY+c+20),e.closePath(),n+=o,i++;if(e.beginPath(),e.moveTo(canvasPaddingX,rt-canvasPaddingY),e.arc(canvasPaddingX,rt-canvasPaddingY,5,0,2*Math.PI,!1),e.fillStyle=a.line.coordNullPointColor,e.fill(),e.closePath(),"up"==a.line.legend){var d=0;for(T=0;T<=a.line.lineTitle.length-1;T++){var f=a.line.lineTitle[T],v=e.measureText(f);d=d+v.width+20}if(ot>d)for(T=0;T<=a.line.lineTitle.length-1;T++){e.beginPath(),e.font="normal"+_+a.general.fontSize+"px"+_+a.general.fontFamily,e.fillStyle=a.line.lineColor[T],e.textAlign="left";var f=a.line.lineTitle[T],v=e.measureText(f),s=s+r+20;e.fillText(a.line.lineTitle[T],ot/2-d/2+s-10,canvasPaddingY-20-c),r=v.width,e.closePath()}}}function P(e){var t,n,i=rt-2*canvasPaddingY,l=ot-2*canvasPaddingX,o=(i/a.line.YData.length,l/a.line.XData.length),r=0;for(var s in a.line.lineData){var c=a.line.lineData[s][0]/a.line.YData[a.line.YData.length-1]*100;t=c/100*i,n=canvasPaddingX;for(var d in a.line.lineData[s]){var c=a.line.lineData[s][d]/a.line.YData[a.line.YData.length-1]*100,f=c/100*i;if(e.beginPath(),e.moveTo(n,rt-canvasPaddingY-t),e.lineTo(n+o,rt-canvasPaddingY-f),e.strokeStyle=a.line.lineColor[r],e.lineWidth=a.width>400?3:1,"right"==a.line.legend&&d==a.line.lineData[s].length-1){e.font=a.width>450?"normal"+_+a.general.fontSize+"px"+_+a.general.fontFamily:"normal"+_+"10px"+_+a.general.fontFamily;var v=a.general.fontSize/2-Math.round(17*a.general.fontSize/100);e.fillStyle=a.line.lineColor[r],e.textAlign="left",e.fillText(a.line.lineTitle[r],n+o+20,rt-canvasPaddingY-f+v)}e.stroke(),e.closePath(),n+=o,t=f}t=a.line.lineData[s][0]/100*i,n=canvasPaddingX;for(var d in a.line.lineData[s]){var c=a.line.lineData[s][d]/a.line.YData[a.line.YData.length-1]*100,f=c/100*i;e.beginPath(),e.moveTo(n+o,rt-canvasPaddingY-f),a.width>400?e.arc(n+o,rt-canvasPaddingY-f,5,0,2*Math.PI,!1):e.arc(n+o,rt-canvasPaddingY-f,2,0,2*Math.PI,!1),e.fillStyle=a.line.lineColor[r],e.fill(),e.closePath(),a.width>400&&a.line.pointOrbit&&(e.save(),e.beginPath(),e.moveTo(n+o,rt-canvasPaddingY-f),e.arc(n+o,rt-canvasPaddingY-f,rt/30,0,2*Math.PI,!1),e.fillStyle=a.line.lineColor[r],e.globalAlpha=.2,e.fill(),e.closePath(),e.restore()),n+=o,t=f}r++}}function w(){}function x(e){m(),k=lt.getContext("2d"),E=lt.relMouseCoords(e),D=E.x,F=E.y;var t=rt-2*canvasPaddingY,n=ot-2*canvasPaddingX,i=n/a.line.XData.length,l=0;q=a.width>400&&a.line.pointOrbit?rt/30+2:a.width>400&&!a.line.pointOrbit?7:4;for(var o in a.line.lineData){L=canvasPaddingX;for(var r in a.line.lineData[o])H=a.line.lineData[o][r]/a.line.YData[a.line.YData.length-1]*100,R=H/100*t,I=D-(L+i),X=F-(rt-canvasPaddingY-R),V=rt/30*(rt/30)>I*I+X*X,V&&(k.clearRect(0,0,ot,rt),y(k),P(k),B=k.measureText(a.line.lineData[o][r]),B=B.width+20,k.save(),k.beginPath(),k.fillStyle=a.line.lineColor[l],k.globalAlpha=.8,k.fillRect(L+i-B/2,rt-canvasPaddingY-R-30-q,B,30),k.closePath(),k.restore(),k.beginPath(),k.font="normal 14px Arial",k.fillStyle="#fff",k.textAlign="center",k.fillText(a.line.lineData[o][r],L+i,rt-canvasPaddingY-R-10-q),k.closePath()),L+=i;l++}}function S(){k=lt.getContext("2d"),b(k,rt/a.pyramid.sections)}function b(e){var t=[],n=0;for(T=0;T<a.pyramid.sections;T++)t.push(a.pyramid.percent?a.pyramid.percent[T]*rt/100:rt/a.pyramid.sections);for(T=0;T<a.pyramid.sections;T++)e.beginPath(),e.fillStyle=a.pyramid.activeColor[T],e.fillRect(0,n,ot,t[T]),n=t[T]+n,e.closePath();for(n=0,T=0;T<a.pyramid.sections;T++)n=t[T]+n,e.save(),e.beginPath(),e.arc(ot/3,n-t[T]/6-10,t[T]/6,0,2*Math.PI,!1),e.fillStyle="rgba(255, 255, 255, 0.7)",e.fill(),e.restore(),textSize=t[T]/6,q=textSize/2-Math.round(17*textSize/100),e.beginPath(),e.fillStyle=a.pyramid.activeColor[T],e.font="bold "+textSize+"px Arial",e.textAlign="center",a.pyramid.percent?e.fillText(a.pyramid.percent[T],ot/3,n-t[T]/6-10+q):e.fillText(a.pyramid.sections-T,ot/3,n-t[T]/6-10+q),e.closePath(),e.restore();for(e.save(),e.beginPath(),e.fillStyle="#A2322E",e.moveTo(0,rt),e.lineTo(ot/3,0),e.lineTo(ot/1.5,rt),e.globalCompositeOperation="destination-in",e.fill(),e.closePath(),e.restore(),n=0,T=0;T<a.pyramid.sections;T++)n=t[T]+n,e.beginPath(),e.moveTo(ot/3,n-1),e.lineTo(ot,n-1),e.strokeStyle=a.pyramid.activeColor[T],e.stroke(),e.restore();for(n=0,T=0;T<a.pyramid.sections;T++)n=t[T]+n,e.save(),e.beginPath(),e.fillStyle="#333",e.font=a.general.fontVariant+_+a.general.fontWeight+_+a.general.fontSize+"px"+_+a.general.fontFamily,e.textAlign="right",e.fillText(a.pyramid.title[T],ot,n-10),e.closePath(),e.restore()}function M(){e(window).resize(function(){waitForFinalEvent(function(){var t=e(window).width();window.windowWidth!=t&&C(!0)},100,"grafikonUniqueStringForResponsiveFunction")})}function C(e){window.resArr.forEach(function(t,n){0==e?window.resValuesArr[n].animation.status=!1:1==e&&(window.resValuesArr[n].animation.status=!0),"evaluation"==window.resValuesArr[n].mode?(window.resValuesArr[n].evaluation.levels=parseInt(window.resValuesArr[n].evaluation.levels,10)-1,t.empty(),t.grafikon(window.resValuesArr[n]),window.resValuesArr[n].evaluation.levels=parseInt(window.resValuesArr[n].evaluation.levels,10)+1):(t.empty(),t.grafikon(window.resValuesArr[n]))})}function A(e,t,n){e.href=t.toDataURL(),e.download=n}var k,T,z,I,Y,E,D,F,I,X,W,O,V,R,L,H,B,q,m,N=new eventFunc,j=[],$=[],Q=[],U=[],G=-.5*Math.PI,J=0,K=0,Z="",_=" ",et=e(this),tt="#"+this.id+" ",nt=this.id,at="#"+a.statistic.statisticId;a.size&&!a.evaluation.infoOut&&(a.height=a.width=a.size);var it=et.parent().width();a.responsive.status&&it>a.responsive.minSize&&it<a.responsive.maxSize?(a.height=it*a.height/a.width,a.width=it):a.responsive.status&&!a.responsive.maxSize?(a.height=it*a.height/a.width,a.width=it):a.responsive.status&&it<a.responsive.minSize?(a.height=a.responsive.minSize*a.height/a.width,a.width=a.responsive.minSize):a.responsive.status&&it>a.responsive.maxSize&&(a.height=a.responsive.maxSize*a.height/a.width,a.width=a.responsive.maxSize),et.append("<canvas width='"+a.width+"' height='"+a.height+"'></canvas>");var lt=document.querySelector(tt+"canvas"),ot=lt.width,rt=lt.height;et.css("width",lt.width).css("position","relative"),et.css("height",lt.height).css("position","relative"),"undefined"!=typeof lt.getContext&&(lt.style.webkitFontSmoothing="antialiased",a.responsive.status&&(window.windowWidth=e(window).width(),lt.setAttribute("data-responsive","true"),e("canvas[data-responsive='true']").length>window.resArr.length&&(window.resArr.push(et),window.resValuesArr.push(a)),M()),"evaluation"==a.mode?(t(et),h()):"doughnut"==a.mode||"pie"==a.mode?(r(et),h()):"progress"==a.mode?(v(et),h()):"line"==a.mode?p(et):"pyramid"==a.mode&&S(et),a.download.status&&(Z=a.download.fileName?a.download.fileName:nt,e("#"+a.download.id).on("click",function(){A(this,lt,Z+".png")})),a.animation.status&&(e(tt).find("canvas").css("display","none"),"fade"==a.animation.effect||"undefined"==typeof jQuery.ui?e(tt).find("canvas").fadeIn(a.animation.duration):e(tt).find("canvas").slideDown({duration:a.animation.duration,easing:"easeOutBounce"})))})}}(jQuery);var a=["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"],b=["","","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"],waitForFinalEvent=function(){var e={};return function(t,n,a){a||(a="Don't call this twice without a uniqueId"),e[a]&&clearTimeout(e[a]),e[a]=setTimeout(t,n)}}();eventFunc.prototype.regEventEx=function(e,t,n){e.attachEvent?(e["e"+t+n]=n,e[t+n]=function(){e["e"+t+n](window.event)},e.attachEvent("on"+t,e[t+n])):e.addEventListener(t,n,!1),e.eventHolder||(e.eventHolder=[]),e.eventHolder[e.eventHolder.length]=new Array(t,n)},eventFunc.prototype.removeEvent=function(e,t,n){e.detachEvent?(e.detachEvent("on"+t,e[t+n]),e[t+n]=null):e.removeEventListener(t,n,!1)},eventFunc.prototype.hasEventEx=function(e,t,n){if(!e.eventHolder)return!1;for(var a=0;a<e.eventHolder.length;a++)if(e.eventHolder[a][0]==eventType&&String(e.eventHolder[a][1])==String(n))return!0;return!1},eventFunc.prototype.removeEventsByTypeEx=function(e,t){if(e.eventHolder){for(var n=0,a=0;a<e.eventHolder.length;a++)e.eventHolder[a][0]==t&&(this.removeEvent(e,t,e.eventHolder[a][1]),e.eventHolder.splice(a,1),n++,a--);return n>0?!0:!1}return!1},HTMLCanvasElement.prototype.relMouseCoords=relMouseCoords;
